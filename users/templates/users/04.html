{% load apptags %}
{% load static %}
<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Личный кабинет</title>
    <style>
        body {
    font-family: Arial, sans-serif;
    background-color: #f0f2f5;
    margin: 0;
    padding: 0;
}
.container {
    width: 70%;
    margin: 50px auto;
    background-color: white;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    border-radius: 8px;
    display: flex;
    flex-direction: column;
}
.breadcrumb {
    font-size: 14px;
    color: #6c757d;
    padding: 20px;
    background-color: #f8f9fa;
    border-bottom: 1px solid #e9ecef;
    border-radius: 8px 8px 0 0;
}
.breadcrumb a {
    text-decoration: none;
    color: #007bff;
}
.breadcrumb a:hover {
    text-decoration: underline;
}
.main {
    display: flex;
}
.sidebar {
    width: 25%;
    background-color: #f8f9fa;
    border-right: 1px solid #e9ecef;
    padding: 20px;
    box-sizing: border-box;
}
.sidebar ul {
    list-style: none;
    padding: 0;
}
.sidebar ul li {
    padding: 10px 0;
}
.sidebar ul li a {
    text-decoration: none;
    color: #473b3b;
    display: flex;
    align-items: center;
    font-size: 16px;
}
.sidebar ul li a:hover, .sidebar ul li a.active {
    color: #007bff;
}
.sidebar ul li a svg {
    margin-right: 10px;
}
.content {
    width: 75%;
    padding: 20px;
}
.content h2 {
    margin-top: 0;
    margin-bottom: 20px;
    font-size: 24px;
    color: #333;
}
.form-group {
    margin-bottom: 15px;
}
.form-group label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    color: #333;
}
.form-group input, .form-group select, .form-group textarea {
    width: 100%;
    padding: 8px;
    box-sizing: border-box;
    border: 1px solid #1570cb;
    border-radius: 4px;
}
.form-group textarea {
    resize: vertical;
}
.form-group small {
    display: block;
    margin-top: 5px;
    color: #6c757d;
}
.buttons {
    margin-top: 20px;
}
.buttons button {
    padding: 10px 20px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
}
.buttons .update-button {
    background-color: #007bff;
    color: white;
}
.buttons .reset-button {
    background-color: #6c757d;
    color: white;
    margin-left: 10px;
}
.appointment-card, .medical-history-card, .order-card {
    background-color: #fff;
    border: 1px solid #ced4da;
    border-radius: 8px;
    padding: 20px;
    margin-bottom: 15px;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    transition: all 0.3s ease;
}
.appointment-card:hover, .medical-history-card:hover, .order-card:hover {
    box-shadow: 0 0 15px rgba(0,0,0,0.2);
}
.appointment-card.past, .order-card.past {
    background-color: #f0f0f0;
    color: #6c757d;
}
.appointment-card.past::after, .order-card.past::after {
    content: '';
    position: absolute;
    top: 50%;
    left: 0;
    width: 100%;
    height: 1px;
    background-color: #6c757d;
    transform: translateY(-50%);
}
.appointment-card h3, .medical-history-card h3, .order-card h3 {
    margin-top: 0;
    font-size: 18px;
    color: #007bff;
    display: flex;
    align-items: center;
}
.appointment-card.past h3, .order-card.past h3 {
    color: #6c757d;
}
.appointment-card h3 svg, .medical-history-card h3 svg, .order-card h3 svg {
    margin-right: 10px;
}
.appointment-card p, .medical-history-card p, .order-card p {
    margin: 5px 0;
    color: #333;
}
.appointment-card .appointment-date, .order-card .order-date {
    font-weight: bold;
    color: #333;
}
.appointment-card.past .appointment-date, .order-card.past .order-date {
    color: #6c757d;
}
.appointment-status, .order-status {
    color: #6c757d;
    font-size: 14px;
}
.tab-content {
    display: none;
}
.tab-content.active {
    display: block;
}
.edit-buttons {
    display: flex;
    justify-content: flex-end;
    margin-top: 10px;
}
.edit-buttons button {
    margin-left: 10px;
}
.medical-history-card .hospital-name, .order-card .hospital-name {
    font-weight: bold;
    color: #333;
}
.medical-history-card .doctor-description, .medical-history-card .doctor-prescription {
    margin-top: 10px;
    padding: 10px;
    background-color: #f8f9fa;
    border-left: 3px solid #007bff;
    border-radius: 4px;
}
.order-details {
    margin-top: 10px;
}
.order-details p {
    margin: 0;
    font-weight: bold;
}
.order-details ul {
    list-style-type: disc;
    padding-left: 20px;
    margin: 5px 0 0 0;
}

    </style>
 <script>
    function showTab(event, tabName) {
        var i, tabcontent, tablinks;
        tabcontent = document.getElementsByClassName("tab-content");
        for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
        }
        tablinks = document.getElementsByClassName("tablink");
        for (i = 0; i < tablinks.length; i++) {
            tablinks[i].className = tablinks[i].className.replace(" active", "");
        }
        document.getElementById(tabName).style.display = "block";
        event.currentTarget.className += " active";
    }

    function editAppointment(id) {
        document.getElementById('edit-' + id).style.display = 'block';
        document.getElementById('view-' + id).style.display = 'none';
    }

    function saveAppointment(id) {
        // Здесь вы можете добавить логику сохранения данных
        document.getElementById('edit-' + id).style.display = 'none';
        document.getElementById('view-' + id).style.display = 'block';
    }

    function cancelEdit(id) {
        document.getElementById('edit-' + id).style.display = 'none';
        document.getElementById('view-' + id).style.display = 'block';
    }

    function deleteAppointment(id) {
        var appointmentCard = document.getElementById('view-' + id);
        appointmentCard.parentNode.removeChild(appointmentCard);
        var editCard = document.getElementById('edit-' + id);
        if (editCard) {
            editCard.parentNode.removeChild(editCard);
        }
    }
</script>
</head>
<body onload="document.getElementById('defaultTab').click();">

<div class="container">
<div class="breadcrumb">
    <a href="{% url 'index' %}">Главная</a> / <a href="#">Пользователь</a> / Личный кабинет
</div>
<div class="main">
    <div class="sidebar">
        <ul>
            <li><a href="#" id="defaultTab" class="tablink active" onclick="showTab(event, 'profile')"><svg width="16" height="16" fill="currentColor" class="bi bi-person" viewBox="0 0 16 16"><path d="M8 8a3 3 0 1 0 0-6 3 3 0 0 0 0 6zM2 14s-1 0-1-1 1-4 6-4 6 4 6 4 1 0 1 1-1 1-1 1H2z"/></svg>Информация профиля</a></li>
            <li><a href="#" class="tablink" onclick="showTab(event, 'appointments')"><svg width="16" height="16" fill="currentColor" class="bi bi-calendar-check" viewBox="0 0 16 16"><path d="M8 10a.5.5 0 0 1 .5.5V13a.5.5 0 0 1-1 0v-2.5a.5.5 0 0 1 .5-.5zm-3.5-3A.5.5 0 0 1 5 7.5V9a.5.5 0 0 1-1 0V7.5A.5.5 0 0 1 4.5 7zM14 3h-1V1h-1v2H4V1H3v2H2a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V5a2 2 0 0 0-2-2zm1 11a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V7h14v7z"/></svg>Запись к врачу</a></li>
            <li><a href="#" class="tablink" onclick="showTab(event, 'video-call')"><svg width="16" height="16" fill="currentColor" class="bi bi-camera-video" viewBox="0 0 16 16"><path d="M1 4.5A1.5 1.5 0 0 1 2.5 3h6A1.5 1.5 0 0 1 10 4.5v.707l2.146-2.147A.5.5 0 0 1 13 3.5v9a.5.5 0 0 1-.854.354L10 10.793v.707A1.5 1.5 0 0 1 8.5 13h-6A1.5 1.5 0 0 1 1 11.5v-7zm1-.5a.5.5 0 0 0-.5.5v7A.5.5 0 0 0 2 11h6a.5.5 0 0 0 .5-.5v-7a.5.5 0 0 0-.5-.5H2zm11 0a.5.5 0 0 0-.354.146L11 5.293v5.414l1.646 1.647a.5.5 0 0 0 .708-.708L12.707 10H11V5.293L12.646 3.646A.5.5 0 0 0 12 3.5z"/></svg>Видео вызов</a></li>
            <li><a href="#" class="tablink" onclick="showTab(event, 'medical-history')"><svg width="16" height="16" fill="currentColor" class="bi bi-file-medical" viewBox="0 0 16 16"><path d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h4.5L14 4.5zm-1-.5H9V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V5z"/><path d="M8 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V8H6a.5.5 0 0 1 0-1h1.5V5.5A.5.5 0 0 1 8 5z"/></svg>История болезни</a></li>
            <li><a href="#" class="tablink" onclick="showTab(event, 'medicine-order')"><svg width="16" height="16" fill="currentColor" class="bi bi-cart" viewBox="0 0 16 16"><path d="M0 1a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 6A.5.5 0 0 1 13 10H5.222l-.1.447a.5.5 0 0 1-.982-.034L3.222 3H1.607l-.5 2H4.5a.5.5 0 0 1 0 1H1a.5.5 0 0 1-.485-.621l.89-4a.5.5 0 0 1 .485-.379H2.89L1.5 6.5l-.9-4A.5.5 0 0 1 .5 1H0zm2 3h1l1.61 7h6.779l1.2-5H3.391L2 4zm3 10a1 1 0 1 0 0-2 1 1 0 0 0 0 2zm5 0a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"/></svg>Заказ лекарств</a></li>
        </ul>
    </div>

    <div class="content">
        <div id="profile" class="tab-content active">
            <h2>Информация профиля</h2>
            <form action="{% url 'users:profile' %}" method="post" >
                {% csrf_token %}
                <div class="form-group">
                    <label for="fullName">Полное имя</label>
                    {{form.full_name}}
                </div>
                <div class="form-group">
                    <label for="email">Адрес электронной почты</label>
                    {{ form.email }}
                </div>
                <div class="form-group">
                    <label for="phone">Номер телефона</label>
                    {{ form.phone }}
                </div>
                <div class="form-group">
                    <label for="dob">Дата рождения</label>
                    {{ form.birthday }}
                    <small>Формат: дд/мм/гггг</small>
                </div>
                <div class="form-group">
                    <label for="gender">Пол</label>
                    <select id="gender" name="gender" required>
                        <option value="">Выберите</option>
                        <option value="female">Женский</option>
                        <option value="male">Мужской</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="location">Место проживания</label>
                    {{ form.location }}
                </div>
                <div class="form-group">
                    <small>Все поля на этой странице являются обязательными.</small>
                </div>
                <div class="buttons">
                    <button type="submit" class="update-button">Обновить профиль</button>
                    <button type="reset" class="reset-button">Сбросить изменения</button>
                </div>
            </form>
        </div>
        <div id="appointments" class="tab-content">
            <h2>Ваши записи к врачу</h2>
            {% if timeslot.type == 'offline' %}
            <div id="view-1" class="appointment-card">
                <h3>Доктор {{timeslot.doctor.name}}</h3>
                <p class="appointment-date">Дата: {{timeslot.available_slot.date}}</p>
                <p>Время: {{timeslot.time}}</p>
                <p>Больница: {{timeslot.doctor.hospital}}</p>
                <p>Отделение: {{timeslot.doctor.specialty.name}}</p>
                <div class="edit-buttons">
                    <a href="{% url 'users:delete_patient' status=1 %}">Изменить</a>
                    <a href="{% url 'users:delete_patient' status=0 %}">Удалить</a>
                </div>
            </div>
            {% endif %}
            <div id="view-2" class="appointment-card past">
                <h3>Доктор Петров</h3>
                <p class="appointment-date">Дата: 15/05/2024</p>
                <p>Время: 10:00</p>
                <p>Больница: Городская больница №2</п>
                <p>Отделение: Терапия</п>
                <p class="appointment-status">Прошедшая запись</p>
            </div>
            <!-- Добавьте больше карточек записей здесь -->
        </div>
        <div id="video-call" class="tab-content">
            <h2>Ваши видео вызовы</h2>
            {% if timeslot.type == 'online' %}
            <div id="view-1" class="appointment-card">
                <h3>Доктор {{ timeslot.doctor.name }}</h3>
                <p class="appointment-date">Дата: {{ timeslot.available_slot.date }}</p>
                <p>Время: {{ timeslot.time }}</p>
                <p>Больница: {{ timeslot.doctor.hospital }}</p>
                <p>Отделение: {{ timeslot.doctor.specialty.name }}</p>
                <div class="edit-buttons">
                    <a href="{% url 'users:delete_patient' status=1 %}">Изменить</a>
                    <a href="{% url 'users:delete_patient' status=0 %}">Удалить</a>
                </div>
            </div>
            {% endif %}
        </div>
        

        <div id="medical-history" class="tab-content">
            <h2>История болезни</h2>
            <div class="medical-history-card">
                <h3><svg width="16" height="16" fill="currentColor" class="bi bi-file-medical" viewBox="0 0 16 16"><path d="M14 4.5V14a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2h4.5L14 4.5zm-1-.5H9V1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h8a1 1 0 0 0 1-1V5z"/><path d="M8 5a.5.5 0 0 1 .5.5V7h1.5a.5.5 0 0 1 0 1H8.5v1.5a.5.5 0 0 1-1 0V8H6a.5.5 0 0 1 0-1h1.5V5.5A.5.5 0 0 1 8 5z"/></svg> Доктор Сидоров</h3>
                <p class="appointment-date">Дата: 10/04/2024</p>
                <p>Время: 09:00</p>
                <п class="hospital-name">Больница: Городская больница №1</п>
                <div class="doctor-description">
                    <п><strong>Описание болезни:</strong> Описание симптомов и диагноза.</п>
                </div>
                <div class="doctor-prescription">
                    <п><strong>Назначения:</strong> Лекарства, которые нужно принимать, и рекомендации по лечению.</п>
                </div>
            </div>
            <!-- Добавьте больше карточек истории болезни здесь -->
        </div>
        <div id="medicine-order" class="tab-content">
            <h2>История заказов лекарств</h2>
            {% for order in orders %}
            <div id="view-order-{{ order.id }}" class="order-card {% if order.status == 'Доставлен' %}past{% endif %}">
                <h3>Заказ №{{ order.id }}</h3>
                <p class="order-date">Дата: {{ order.created_timestamp|date:"Y-m-d H:i:s" }}</p>
                <p>Место заказа: {{order.receiver_address}}</p>
                <p>Сумма: {{order.total_price}} BYN</p>
                <p>Статус: {{ order.status }}</p>
                <div class="order-details">
                    <p><strong>Лекарства:</strong></p>
                    <ul>
                        {% for basket in order.baskets.all %}
                        <li>{{ basket.product.name }} - {{ basket.quantity }} шт.</li>
                    {% endfor %}
                    </ul>
                </div>
                <p><strong>Оплачено:</strong> Да</p>
            </div>
            {% endfor %}
           
            <!-- Добавьте больше карточек заказов здесь -->
        </div>
    </div>
</div>
</div>

</body>
</html>